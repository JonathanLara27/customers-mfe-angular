<div class="table-responsive table-container">
    @if (isLoading()) {
    <div class="loading-shade">
        <mat-spinner></mat-spinner>
    </div>
    }

    <table mat-table [dataSource]="tableDataSource()" class="mat-elevation-z8 table-border">

        @for (column of columns(); track $index) {
            <ng-container [matColumnDef]="column.field">
                <th mat-header-cell *matHeaderCellDef>
                    <div [class]="cellClassHeader(column)">
                        {{column.header}}
                    </div>
                </th>
                <td mat-cell *matCellDef="let element">
                    <div [ngClass]="[column.cellClass2 ? column.cellClass2(element) : column.cellClass]">
                        @switch (column.type) {
                            @case ('date') {
                                {{element[column.field] | date : 'dd/MM/yyyy'}}
                            }
                            @case ('datetime') {
                                {{element[column.field] | date : 'dd/MM/yyyy hh:mm:ss a'}}
                            }
                            @case ('number') {
                                @if (element[column.field] !== null && element[column.field] !== undefined) {
                                    {{element[column.field] | number:'1.2-2'}}
                                }@else {
                                    {{'0'}}
                                }
                            }
                            @default {
                                {{element[column.field]}}
                            }
                        }
                    </div>
                </td>
            </ng-container>
        }

        @if (buttonColumn()) {
            <ng-container [matColumnDef]="buttonColumn()!.field" stickyEnd>
                <th mat-header-cell *matHeaderCellDef>
                    {{buttonColumn()!.header}}
                </th>
                <td mat-cell *matCellDef="let element; let i=index">
                    <section class="d-grid-buttons">
                        @for (button of buttonColumn().buttons; track $index) {
                        <app-action-button [button]="button" [element]="element" [isLoading]="isLoading()"
                            (action)="onButtonClick($event, element)"></app-action-button>
                        }
                    </section>
                </td>
            </ng-container>
        }

        <tr mat-header-row *matHeaderRowDef="displayedColumns() sticky : true" class="header-table"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns();" class="element-row"></tr>

    </table>


</div>